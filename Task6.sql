-- ============================================
-- DATABASE & TABLE CREATION
-- ============================================
CREATE DATABASE IF NOT EXISTS online_sales;
USE online_sales;

DROP TABLE IF EXISTS orders;

CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    order_date DATE,
    product_id INT,
    amount DECIMAL(10,2)
);

-- ============================================
-- SAMPLE DATASET (50 Records)
-- ============================================
INSERT INTO orders (order_id, order_date, product_id, amount) VALUES
(1, '2024-01-03', 101, 250.00),
(2, '2024-01-05', 102, 499.00),
(3, '2024-01-15', 103, 320.00),
(4, '2024-01-22', 104, 150.00),
(5, '2024-01-27', 101, 220.00),

(6, '2024-02-02', 102, 499.00),
(7, '2024-02-03', 103, 330.00),
(8, '2024-02-10', 104, 180.00),
(9, '2024-02-18', 101, 270.00),
(10, '2024-02-26', 105, 540.00),

(11, '2024-03-01', 101, 260.00),
(12, '2024-03-04', 106, 720.00),
(13, '2024-03-12', 103, 310.00),
(14, '2024-03-15', 104, 199.00),
(15, '2024-03-25', 105, 560.00),

(16, '2024-04-02', 101, 250.00),
(17, '2024-04-07', 103, 315.00),
(18, '2024-04-11', 104, 200.00),
(19, '2024-04-19', 102, 480.00),
(20, '2024-04-29', 106, 710.00),

(21, '2024-05-03', 101, 260.00),
(22, '2024-05-08', 103, 320.00),
(23, '2024-05-12', 102, 499.00),
(24, '2024-05-21', 104, 210.00),
(25, '2024-05-27', 105, 550.00),

(26, '2024-06-01', 106, 700.00),
(27, '2024-06-03', 103, 310.00),
(28, '2024-06-14', 101, 240.00),
(29, '2024-06-19', 102, 490.00),
(30, '2024-06-25', 104, 220.00),

(31, '2024-07-02', 101, 255.00),
(32, '2024-07-05', 103, 330.00),
(33, '2024-07-12', 104, 210.00),
(34, '2024-07-19', 105, 580.00),
(35, '2024-07-28', 102, 500.00),

(36, '2024-08-01', 106, 720.00),
(37, '2024-08-04', 103, 325.00),
(38, '2024-08-09', 104, 215.00),
(39, '2024-08-17', 101, 245.00),
(40, '2024-08-21', 105, 590.00),

(41, '2024-09-03', 101, 250.00),
(42, '2024-09-07', 103, 330.00),
(43, '2024-09-11', 104, 210.00),
(44, '2024-09-19', 102, 490.00),
(45, '2024-09-26', 106, 710.00),

(46, '2024-10-02', 101, 260.00),
(47, '2024-10-06', 105, 600.00),
(48, '2024-10-11', 103, 340.00),
(49, '2024-10-15', 104, 220.00),
(50, '2024-10-28', 102, 500.00);

-- ============================================
-- MONTHLY SALES TREND ANALYSIS
-- ============================================
SELECT 
    YEAR(order_date) AS order_year,
    MONTH(order_date) AS order_month,
    SUM(amount) AS monthly_revenue,
    COUNT(DISTINCT order_id) AS order_volume
FROM orders
GROUP BY YEAR(order_date), MONTH(order_date)
ORDER BY order_year, order_month;

